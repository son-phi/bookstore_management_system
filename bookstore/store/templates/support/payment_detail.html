{% extends "base.html" %}
{% block title %}Payment{% endblock %}
{% block content %}
<h3>Payment #{{ payment.paymentID }}</h3>

<div class="card">
  <div class="card-body">
    <div><b>Order:</b> #{{ order.orderID }}</div>
    <div><b>Amount:</b> {{ payment.amount }}</div>
    <div><b>Method:</b> {{ payment.method }}</div>
    <div><b>Status:</b> <span class="badge bg-dark">{{ payment.status }}</span></div>

    {% if transaction %}
      <hr>
      <div><b>Transaction Ref:</b> {{ transaction.gatewayRef }}</div>
      <div><b>Timestamp:</b> {{ transaction.timestamp }}</div>
    {% endif %}

    <div class="mt-3 d-flex gap-2">
      {% if payment.method == "ONLINE" and payment.status != "SUCCESS" %}
        <form method="post" action="/payments/{{ payment.paymentID }}/confirm/">
          {% csrf_token %}
          <button class="btn btn-success">Confirm payment (Mock)</button>
        </form>
      {% endif %}

      {% if payment.status == "SUCCESS" %}
        <form method="post" action="/payments/{{ payment.paymentID }}/refund/">
          {% csrf_token %}
          <button class="btn btn-outline-danger">Refund (Mock)</button>
        </form>
      {% endif %}

      <a class="btn btn-outline-secondary" href="/orders/{{ order.orderID }}/">Back to order</a>
    </div>
  </div>
</div>
{% endblock %}
